<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/AhmedLotfy992/DataEntryVinchi/bulma.css"
    />
    <style>
      .white-datepicker-icon::-webkit-calendar-picker-indicator {
          filter: invert(1); /* Inverts the color */ 
      }
  </style>
    
  </head>
  <body>
    <section class="hero is-primary is-bold " >
      <div class="hero-body">
        <div class="container">
          <h1 class="title">Vinchi Data Entry</h1>
        </div>
      </div>
    </section>
    <form id="form" class="container is-fluid" method="POST">
      

      <div class="field">
        <label class="label">Order ID :</label>
        <div class="control">
          <input
            class="input"
            type="text"
            placeholder="Order ID From Company...."
            name="Order ID"
            autocomplete="off"
            required
          />
        </div>
      </div>

      <!-- <div class="field">
        <label class="label">Last Name</label>
        <div class="control">
          <input
            class="input"
            type="text"
            placeholder="Your Last Name"
            name="Last Name"
          />
        </div>
      </div> -->

    <div class="control">
      <label class="label">Company :</label>
      <div class="select">
        <select  name="Company" required>
        <option disabled selected value selected="selected"> Select A Compnay... </option>
        <option value="vinchi sh">Vinchi sh</option>
        <option value="Kemmit">Kemmit</option> 
        <option value="Manzelli">Manzelli</option> 
        <option value="Homzmart">Homezmart</option> 
        <option value="Noon">Noon</option> 
        <option value="Chic Homz">Chic Homz</option> 
        <option value="Amazon">Amazon</option>
        <option value="Byoot Misr">Byoot Misr</option>
        <option value="Oscar">Oscar</option>
        <option value="Raneen">Raneen</option>
        <option value="Amazon Retail">Amazon Retail</option>
        <option value="Amazon DF">Vinchi</option>
        <option value="Aman">Aman</option>
        </select>
      </div>
    </div>

      

      <div class="field">
        <label class="label">SKU :</label>
        <div class="control">
            <input
                class="input"
                id="SKU"
                type="text"
                placeholder="Enter SKU"
                name="SKU"
                oninput="validateInput('SKU')"
            />
            <p id="skuErrorMessage" style="color: red;"></p> <!-- Separate error message for SKU -->
        </div>
    </div>


      <div class="field">
        <label class="label">QNT :</label>
        <div class="control">
          <input
            class="input"
            type="number"
            placeholder="Order Quantity"
            name="QNT"
            required
          />
        </div>
      </div>


      <div class="field">
        <label class="label">Custom Order Notes :</label>
        <div class="control">
          <textarea
            class="textarea"
            placeholder="Any Customization If Present..."
            name="Custome order"
          ></textarea>
        </div>
      </div>


      <div class="control">
        <label class="label">Order Status :</label>
        <div class="select">
          <select name="Status" required>
          <option disabled selected value selected="selected"> Select Status... </option>
          <option value="جديد">جديد</option>
          </select>
        </div>
      </div>

      <div class="field">
        <label class="label">Order Date  :</label>
        <div class="control">
          <input
            class="input white-datepicker-icon"
            type="date"
            placeholder="Your Date of Birth"
            name="Order Date"
            required
          />
        </div>
      </div>

      <div class="field">
        <label class="label">Customer Name  :</label>
        <div class="control">
          <input
            class="input"
            autocomplete="off"
            type="text"
            placeholder="Name Of Order placer"
            name="customer Name"
            required
          />
        </div>
      </div>

      <div class="field">
        <label class="label">Phone Number :</label>
        <div class="control">
            <input
                class="input"
                id="phoneNumber"
                type="text"
                autocomplete="off"
                placeholder="Enter phone number"
                name="Phone Number"
                oninput="validateInput('phoneNumber')"
            />
            <p id="phoneErrorMessage" style="color: red;"></p> <!-- Separate error message for phone number -->
        </div>
    </div>

    <label class="label">Order Price :</label>
    <div class="field has-addons ">
      <p class="control">
        <span class="select">
          <select>
            <option>EGP.</option>
          </select>
        </span>
      </p>
      <p class="control is-expanded">
        <input class="input" type="number" placeholder="Amount of money" name="Order Price">
      </p>
      
    </div>


    <label class="label">Shipping :</label>
    <div class="field has-addons ">
      <p class="control">
        <span class="select">
          <select>
            <option>EGP.</option>
          </select>
        </span>
      </p>
      <p class="control is-expanded">
        <input class="input" type="number" placeholder="Amount of money" name="shipping" required>
      </p>
      
    </div>





    <label class="label">Deposite :</label>
    <div class="field has-addons ">
      <p class="control">
        <span class="select">
          <select>
            <option>EGP.</option>
          </select>
        </span>
      </p>
      <p class="control is-expanded">
        <input class="input" type="number" placeholder="Amount of money" name="Deposit" required>
      </p>
      
    </div>



    <div class="control">
      <label class="label">Payment Method :</label>
      <label class="radio">
        <input type="radio" name="paymentMethod" value="COD"  required/>
        COD
      </label>
      <label class="radio">
        <input type="radio" name="paymentMethod" value="Credit"  required/>
        Credit
      </label>
    </div>




    <div class="control">
      <label class="label">Area :</label>
      <div class="select">
        <select name="Area" required>
        <option disabled selected value selected="selected"> Select An Area of Address... </option>
        <option value="القاهره">القاهره</option>
        <option value="الجيزه">الجيزه</option> 
        <option value="اكتوبر">اكتوبر</option> 
        <option value="مخزن كيميت">Homezmart</option> 
        <option value="مخزن اوسكار">مخزن اوسكار</option> 
        <option value="الاسكندرية">الاسكندرية</option> 
        <option value="الاسماعلية">الاسماعلية</option>
        <option value="البحر الاحمر">البحر الاحمر</option>
        <option value="البحيرة">البحيرة</option>
        <option value="بور سعيد">بور سعيد</option>
        <option value="الدقهلية ">الدقهلية </option>
        <option value="دمياط">دمياط</option>
        <option value="السويس ">السويس</option>
        <option value="الشرقية">الشرقية</option>
        <option value="الغربية ">الغربية</option>
        <option value="القليوبية ">القليوبية</option>
        <option value="كفر الشيخ">كفر الشيخ</option>
        <option value="مطروح">مطروح</option>
        <option value="الساحل">الساحل</option>
        <option value="المنوفية">المنوفية</option>
        <option value="مخزن شيك هومز">مخزن شيك هومز</option>
        
        </select>
      </div>
    </div>


    

      <div class="field">
        <label class="label">Address :</label>
        <div class="control">
          <textarea
            class="textarea"
            placeholder="Added All Address Details..."
            name="Address"
            required
          ></textarea>
        </div>
      </div>

      <div class="field is-grouped">
        <div class="control">
          <button class="button is-primary" type="submit" id="submit-button">
            Add Order
          </button>
        </div>
        <div class="control">
          <button class="button is-danger" type="button" id="reset-button"  onclick="location.reload();">Cancel</button>
        </div>
      </div>
    </form>
    <div
      id="message"
      style="
        display: none;
        margin: 20px;
        font-weight: bold;
        color: green;
        padding: 8px;
        background-color: beige;
        border-radius: 4px;
        border-color: aquamarine;
      "
    ></div>

    <script>
      document.getElementById("form").addEventListener("submit", function (e) {
        e.preventDefault(); // Prevent the default form submission
        document.getElementById("message").textContent = "Submitting..";
        document.getElementById("message").style.display = "block";
        document.getElementById("submit-button").disabled = true;

        // Collect the form data
        var formData = new FormData(this);
        var keyValuePairs = [];
        for (var pair of formData.entries()) {
          keyValuePairs.push(pair[0] + "=" + pair[1]);
        }

        var formDataString = keyValuePairs.join("&");
        
        // Send a POST request to your Google Apps Script
        fetch("https://script.google.com/macros/s/AKfycbxhUFWAaZT8O8h5hA2ZMS7PHsySajDhi_5oFIuHu5fPhotAzX99_tVKZMZ4KvoKT8op1w/exec", {
          method: "POST",
          headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
            },
          body: formDataString,
        })
          .then(function (response) {
            // Check if the request was successful
            if (response) {
              return response; // Assuming your script returns JSON response
            } else {
              throw new Error("Failed to submit the form.");
            }
          })
          .then(function (data) {
            // Display a success message
            document.getElementById("message").textContent =
              "Data submitted successfully!";
            document.getElementById("message").style.display = "block";
            document.getElementById("message").style.backgroundColor = "green";
            document.getElementById("message").style.color = "beige";
            document.getElementById("submit-button").disabled = false;
            document.getElementById("form").reset();

            setTimeout(function () {
              document.getElementById("message").textContent = "";
              document.getElementById("message").style.display = "none";
            }, 2600);
          })
          .catch(function (error) {
            // Handle errors, you can display an error message here
            console.error('Submission failed:', error);
            document.getElementById("message").textContent =
              "An error occurred while submitting the form.";
            document.getElementById("message").style.display = "block";

            fetch("https://script.google.com/macros/s/AKfycbyPyjaujFQDUmG372B7DzR_8Y5jQyCOdl9ZARWO2e8XxNtgz7XYVolDPzqA4N8IQSFikw/exec?action=sendErrorEmail&message=" + encodeURIComponent(error.message));
          });
      });


      const validInputs = ["VW2","VW5","VW6","VW7","VW9","VW10","VW11","VW12","VW13","VW15","VW20","VW21","VW35","VW40","VW45","VW49","VW61","VW63","VW66","VW67","VW71","VW72","VW76","VW77","VW80","VW81","VW16","VW22","VW28","VW27","VW43","VW44","VW46","VW50","VW57","VW60","AFC11","AFC14","AFC35","AFC41","AFC63","AFC74","AFC82","AFC83","AFC86","AFC87","AFC91","AFC92","AFCT10","VW89","VCTM3","AFC15","AFC26","AFC27","AFC29","AFC30","AFC31","AFC32","AFC34","AFC48","AFC55","AFC56","AFC62","AFC69","AFC70","AFC79","AFC84","AFC88","AFC89","AFC90","AFC95","AFC189","AFCT1","AFCT3","AFCT4","AFCT6","AFCT7","AFCT8","AFCT9","AFCT12","AFCT16","AFCT19","AFCT26","AFCT29","AFCT30","VW84","VW85","VCTM","VCTM4","VCTM5","VCTM6","VCTM7","VCTM9","VCTM10","VCTA","VCTA 4","VCTA 6","VCTA 7","VCTA 8","VW79","VW82","AFCT17","AFCT20","AFO2","AFO6","AFO7","AFO9","AFO14","AFO3","AFO4","AFO5","AFO8","AFO10","AFO11","AFO12","AFO13","AFO16","AFO17","AFO18","AFO19","AFO21","AFO23","AFO24","AFO25","AFO28","AFD1","AFD3","AFD4","AFD5","AFD6","AFD7","AFD8","AFD12","AFD13","AFD14","AFD15","AFD16","AFD17","AFD18","AFD19","AFD23","AFD24","AFD29","AFD30","AFD31","AFD32","AFD33","AFD34","AFD35","AFD36","AFD37","VW83","AFD21","AFD27","AFD28","VW29","VW34","VW36","VW37","VW38","VW42","VW48","VW51","VW53","VW54","VW56","VW58","VW59","VW64","AFD2","AFD49","AFR3","AFR5","AFR6","AFR7","AFR13","AFR19","AFR20","AFR31","AFR32","AFR35","AFR36","AFR4","AFR9","AFR12","AFR14","AFR15","AFR25","AFR26","AFR28","AFR30","VW96","AFK2","AFK5","AFK7","AFK8","AFK9","AFK20","AFK22","AFK29","AFK30","AFK1","AFK3","AFK4","AFK6","AFK15","AFK19","AFK21","AFK31","AFK32","VW90","VW91","VW92","VW93","VW94","VW95","VW99","VW23","VW24","VW55","VW69","VW68","VW73","VW78","OV1","OV2","OV3","OV4","OV5","OV6","OV7","OV8","OV9","OV13","OV14","OV15","OV16","OV18","OV19","OV21","OV22","OV23","OV25","OV26","OV27","OV28","OV29","OV30","OV31","OV32","OV33","OV34","OV35","OV36","OV37","OV38","OV39","OV40","OV41","OV42","OV43","OV44","OV45","OV46","OV47","OV48","OV49","OV50","AFS16","AFS24A","AFS25A","AFS33A","AFS38A","AFS54A","AFS73A","AFS80","AFS81","VW25","VW86","VW87","VSTM1","VW97","VW98","VCTM2","AFCT11","VCTA 5","VTVM 5","VTVM5","VTVM 6","VTVM6","VW74","VW75","VTVM","VTVM2","VTVM 3","VTVM3","VTVM 4","VTVM4","NFR1","NFR2","NFR3","NFR4","NFR5","NFR6","NFR7","NFR8","NFR9","NFR10","NFR11","NFR12","NFR13","NFR14","NFR15","NFR16","NFR17","NFR18","NFR19","NFR20","NFR21","NFR23","NFR24","NFR25","NFR26","NFR27","NFR28","NFR29","NFR30","NFR31","NFR32","NFR33","NFR34","NFR35","NFR36","NFR37","NFR38","NFR39","NFR40","NFR41","NFR42","NFR43","NFR44","NFR45","NFR46","NFR47","NFR49","NFR50","NFR51","NFR52","NFR53","NFR54","NFR55","NFR56","NFR57","NFR58","NFR59","NFR61","NFR62","NFR63","NFR64","NFR65","NFR66","NFR67","NFR68","NFR69","NFR70","NFR71","NFR72","NFR73","NFR74","NFR75","NFR76","NFR77","NFR78","NFR79","NFR80","NFR81","NFR82","NFR83","NFR84","NFR85","NFR88","NFR89","NFR90","NFR93","NFR94","NFR95","NFR96","NFR97","NFR98","NCT1","NCT2","NCT3","NCT4","NCT5","NCT6","NCT7","NCT8","NCT9","NCT10","NCT11","NCT12","NCT13","NCT14","NCT15","NCT16","NCT17","NCT18","NCT19","NCT20","NCT21","NCT22","NCT23","NCT24","NCT25","NCT26","NCT27","NCT28","NCT29","NCT30","NCT31","NCT32","NCT33","NCT34","NCT35","NCT36","NCT37","NCT38","NCT39","NCT40","NCT41","NCT42","NCT43","NCT44","NCT45","NCT46","NCT47","NCT48","NCT49","NCT50","NCT51","NCT52","NCT53","NCT54","NCT55","NCT56","NCT57","NCT58","NCT59","NCT60","NCT61","NCT62","NCT63","NCT64","NCT65","NCT66","NCT67","NCT68","NCT69","NCT70","NCT71","NCT72","NCT73","NCT74","NCT75","NCT76","NCT77","NCT78","NCT79","NCT80","NCT81","NCT82","NCT83","NCT84","NCT85","NCT86","NCT87","NCT88","NCT89","NCT90","NCT91","NCT92","NCT93","NCT94","NCT95","NCT96","NCT97","NCT98","NCT99","NCT100","NCT101","NCT102","NCT103","NCT104","NCT105","NCT106","NCT107","NCT108","NCT109","NCT110","NCT111","NCT112","NCT113","NCT114","NCT115","NCT116","NCT117","NCT118","NCT119","NCT120","NCT121","NCT122","NCT123","NCT124","NCT125","NCT126","NCT127","NCT128","NCT129","NCT130","NCT131","NCT132","NCT133","NCT134","NCT135","NCT136","NCT137","NCT138","NCT139","NCT140","NCT141","NCT142","NCT143","NCT144","NCT145","NCT146","NCT147","NCT148","NCT149","NCT150","NCT151","NCT152","NCT153","NCT154","NCT155","NCT156","NCT157","NCT158","NCT159","NCT160","NCT161","NCT162","NCT163","NCT164","NCT165","NCT166","NCT167","NCT168","NCT169","NCT170","NCT171","NCT172","NCT173","NCT174","NCT175","NCT176","NCT177","NCT178","NCT179","NCT180","NCT181","NCT182","NCT183","NCT184","NCT185","NCT186","NCT187","NCT188","NCT189","NCT190","NCT191","NCT192","NCT193","NCT194","NCT195","NCT196","NCT197","NCT198","NCT199","NCT200","NDU1","NDU2","NDU3","NDU4","NDU5","NDU6","NDU7","NDU8","NDU9","NDU10","NDU11","NDU12","NDU13","NDU14","NDU15","NDU16","NDU17","NDU18","NDU19","NDU20","NDU21","NDU22","NDU23","NDU24","NDU25","NST1","NST2","NST3","NST4","NST5","NST6","NST7","NST8","NST9","NST10","NST11","NST12","NST13","NST14","NST15","NST16","NST17","NST18","NST19","NST20","NST21","NVT1","NVT2","NVT3","NVT4","NVT5","NVT6","NVT7","NVT8","NVT9","NVT10","NVT11","NVT12","NVT13","NVT14","NVT15","NVT16","NVT17","NVT18","NVT19","NVT20","NVT22","NVT23","NVT25","NVT26","NVT27","NVT28","NVT29","NVT30","NVT31","NVT32","NVT33","NVT34","NVT35","NVT36","NVT37","NVT38","NVT39","NVT40","NVT42","NVT43","NBR3","NBR 4","NBR 5 ","NBR 6 ","NBR 7 ","NBR 8 ","NBR 9 ","NBR 10 ","NBR 11 ","NBR 12 ","NBR 13 ","NBR 14 ","NBR 15 ","NBR16","NBR 17 ","NBR18","NBR 19 ","NBR 20 ","NBR 21 ","NBR 22 ","NBR4","CUSTOMIZED ITEM (CABINET) VW61","CUSTOM COFFEE TABLE VCTM9"," (NCT54) درجه اللون (LAMAICA 3696)","AFC58","R-164","CUSTOM (AFO21)","CUSTOM VW95","H-10","CUSTOM NCT93","CUSTOM  VTVM2","CUSTOM NVT27","CUSTOM NFR19","CUSTOM AFR13","CUSTOM VTVM","R-153","CUSTOM NCT85","R-158","CUSTOM AFC189","AFC58","CUSTOM AFR26","KT-105","R-151","R-163","A18","A4","A6","AFC32A","AFC69A","AFC79A","H17","KT-105","KT-109","R-151","R-163","R-166","R-178","TV162","TV170","R-161","TT-100","TT-107","TT-102","TT-104","3-B","VCTA6","R-162","TT-108","AFC49","NCT70-CUS","AFR36-CUS","AFD49-CUS","NCT93-CUS","CAT-50-1","CAT-50-3","NFR15-CUS","VTVM-CUS","CT17","VCTA8","NVB19","NVB3","R-154"];

      function validateInput(inputType) {
    var inputElement, errorMessageId, isValid;

    if (inputType === "phoneNumber") {
        inputElement = document.getElementById("phoneNumber");
        errorMessageId = "phoneErrorMessage";
        var phonePattern = /^[0-9]{11}$/;
        isValid = phonePattern.test(inputElement.value);
    } else if (inputType === "SKU") {
        inputElement = document.getElementById("SKU");
        errorMessageId = "skuErrorMessage";
        inputElement.value = inputElement.value.toUpperCase();
        isValid = validInputs.includes(inputElement.value);
    }

    var errorMessageElement = document.getElementById(errorMessageId);
    if (isValid) {
        errorMessageElement.textContent = "";
    } else {
        errorMessageElement.textContent = inputType === "phoneNumber" ? 
            "Invalid phone number. Please enter a valid number." : 
            "Invalid SKU, Please Enter Company's SKU or Call Help...";
    }

    return isValid;
}





    </script>
  </body>
</html>